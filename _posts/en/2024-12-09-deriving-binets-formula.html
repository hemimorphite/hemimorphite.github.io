---
layout: post
lang: en
locale: en
title: "Deriving Binet's Formula"
thumb: "binetformula.jpg"
eyebrow: "Tutorial"
description: "Explore the fascinating derivation of Binet's Formula, a closed-form expression for Fibonacci numbers, using mathematical tools like recurrence relations, generating functions, and properties of the golden ratio."
date: 2024-12-09 15:20:00 +0700
author: Samuel Yang
categories: ["Tutorial", "year-2024", "month-12", "day-09"]
tags: ["math", "fibonacci", "recurrence relation", "generating function", "binet formula"]
---

<div class="blog-post">
    {% include post-header.html %}

    <article class="post-content">
		
        <p>The Fibonacci sequence, one of the most renowned number sequences in mathematics, is named after Leonardo of Pisa, a prominent mathematician of the European Middle Ages. Born in 1170 into the Bonacci family, Leonardo later became known as Fibonacci — a name derived from the Latin phrase Filius Bonacci, meaning "son of Bonacci."</p>

        <p>In his book Liber Abaci (1202), he introduced the now-famous Fibonacci sequence:</p>
		
		\[ 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, ... \]
		
		<p>This sequence arose from an arithmetic problem about counting rabbit pairs, where each term represents the total number of rabbit pairs in a given month. The pattern is that each term is the sum of the two preceding terms. This means the Fibonacci sequence can be defined recursively as follows:</p>
		
		\[ F_{0} = 1, F_{1} = 1, F_{n} = F_{n-1} + F_{n-2} \text{ for } n \geq 2 \]
		
		<p>It turns out that the Fibonacci sequence also has a closed-form expression, known as Binet's formula. It is given by:</p>
		
		\[ F_{n} = \frac{\phi^{n} - \psi^{n}}{\sqrt{5}}, \]
		
		<p>where:</p>
		
		\[ \phi = \frac{1 + \sqrt{5}}{2}, \quad \psi = \frac{1 - \sqrt{5}}{2}. \]
		
		<p>Here, \(\phi\) and \(\psi\) are the roots of the characteristic equation associated with the Fibonacci recurrence relation. Binet's formula provides an exact value for \(F_{n}\) without requiring recursive computation, beautifully connecting the Fibonacci sequence to algebra and the golden ratio.</p>
		
		<p>For any sequence of numbers, there exists an associated generating function that encodes the sequence into a formal power series. Given a sequence \(\{a_n\}_{n=0}^{\infty}\), the generating function \(G(x)\) is defined as:</p>
		
		\[ G(x) = \sum_{n=0}^{\infty} a_n x^{n}  \]
		
		<p>If we change the sequence by adding \(k\) zeros to the left \(\{0, 0, ..., 0, a_{0}, a_{1}, a_{2}, ... \}\), then the new generating function is \(x^{k}G(x) = a_{0} x^{k} + a_{1} x^{k+1} + a_{2} x^{k+2} + ...\).</p>
		
		<p>Recall that the Fibonacci sequence are defined by the recurrence relation</p>
		
		\[ F_{0} = 1, F_{1} = 1, F_{n} = F_{n-1} + F_{n-2} \text{ for } n \geq 2 \]
		
		<p>We begin by defining the generating function for the Fibonacci sequence as the formal power series whose coefficients are the Fibonacci sequence themselves,</p>
		
		\[ F(x) = \sum_{n=0}^{\infty} F_{n} x^{n} \]
		
		<p>When dealing with a recurrence relation like the Fibonacci sequence, where the recurrence starts with two defined initial terms (\(F_{0}\) and \(F_{1}\)), shifting the generating function twice to the right is necessary to properly represent the recurrence algebraically.</p>
		
		<p>We multiply the generating function for the Fibonacci sequence with \(x\) and \(x^{2}\) to shift the terms:</p>
		
		\[
		\begin{aligned}
		F(x)  &= F_{0} + F_{1} x + F_{2} x^{2} + F_{3} x^{3} + F_{4} x^{4} + F_{5} x^{5} + F_{6} x^{6} + \dots \\
		xF(x) &= \phantom{F_{0} x +} F_{1} x^{2} + F_{2} x^{3} + F_{3} x^{4} + F_{4} x^{5} + F_{5} x^{6} + \dots \\
		x^{2}F(x) &= \phantom{F_{0} x^{2} +} F_{1} x^{3} + F_{2} x^{4} + F_{3} x^{5} + F_{4} x^{6} + \dots
		\end{aligned}
		\]

		<p>When we multiply \(F(x)\) by \(x\), it shifts all terms of the sequence to the right by one position:</p>
		
		\[ xF(x) = x\sum_{n=0}^{\infty} F_{n} x^{n} = \sum_{n=0}^{\infty} F_{n} x^{n+1} = \sum_{n=1}^{\infty} F_{n-1} x^{n} \]
		
		<p>When we multiply \(F(x)\) by \(x^{2}\), it shifts all terms of the sequence to the right by two positions:</p>
		
		\[ x^{2}F(x) = x^{2}\sum_{n=0}^{\infty} F_{n} x^{n} = \sum_{n=0}^{\infty} F_{n} x^{n+2} = \sum_{n=2}^{\infty} F_{n-2} x^{n} \]
		
		<p>The initial terms \(F_{0}\) and \(F_{1}\) need to be added explicitly because they are not part of the recurrence relation and subsitute the recurrence relation for \(F_{n}\) into the coefficients of the sum.</p>
		
		\[
		\begin{aligned}
		F(x) &= F_{0} x^{0} + F_{1} x^{1} + \sum_{n=2}^{\infty} F_{n} x^{n} \\
		&= F_{0} + F_{1} x + \sum_{n=2}^{\infty} (F_{n-1} + F_{n-2}) x^{n} \\
		&= F_{0} + F_{1} x + \sum_{n=2}^{\infty} F_{n-1} x^{n} + \sum_{n=2}^{\infty} F_{n-2} x^{n} \\
		&= F_{0} + F_{1} x + x\sum_{n=2}^{\infty} F_{n-1} x^{n-1} + x^{2}\sum_{n=2}^{\infty} F_{n-2} x^{n-2} \\
		&= F_{0} + F_{1} x + x(\sum_{n=0}^{\infty} F_{n} x^{n} - F_{0}) + x^{2}\sum_{n=0}^{\infty} F_{n} x^{n} \\
		&= F_{0} + F_{1} x + x(F(x) - F_{0}) + x^{2} F(x) \\
		&= F_{0} + F_{1} x + x F(x) - F_{0} x + x^{2} F(x)
		\end{aligned}
		\]
		
		<p>From the initial conditions \(F_{0} = 0\) and \(F_{1} = 1\), the equation simplifies to:</p>
		
		\[ F(x) = x + x F(x) + x^{2} F(x) \]
		
		<p>Sovling for the generating function, we get:</p>
		
		\[ F(x) = \frac{x}{1 - x - x^{2}} \]
		
		<p>Now that we have found a closed form for the generating function, all that remains is to express this function as a power series. After doing so, we may match its coefficients term-by-term with the corresponding Fibonacci numbers. The roots of the polynomial \(1 − x − x^{2}\) are \(-\phi\) and \(-\psi\), where</p>
		
		\[ \phi = \frac{1 + \sqrt{5}}{2} \]
		
		<p>and</p>
		
		\[ \psi = \frac{1 - \sqrt{5}}{2}, \]
		
		<p>so the polynomial factors as \(1-x-x^{2}=-(x+\phi)(x+\psi)\).</p>
		
		<p>In order to express the generating function as a power series, we will use the partial fraction decomposition to express it in the form</p>
		
		\[ F(x) = -\frac{x}{(x+\phi)(x+\psi)} = \frac{A}{x+\phi} + \frac{B}{x+\psi}, \]
		
		<p>which is equivalent to</p>
		
		\[ -x = A(x+\psi) + B(x+\phi). \]
		
		<p>Letting \(x=-\phi\):</p>
		
		\[
		\begin{aligned}
		-x &= A(x+\psi) + B(x+\phi) \\
		-(-\phi) &= A(-\phi+\psi) + B(-\phi+\phi) \\
		\phi &= A(-\phi+\psi) \\
		A &= \frac{\phi}{\psi-\phi}
		\end{aligned}
		\]
		
		<p>Using the fact that \(\psi-\phi=-\sqrt{5}\), we get:</p>
		
		\[ A &= -\frac{\phi}{\sqrt{5}}. \]
		
		<p>Letting \(x=-\psi\):</p>
		
		\[
		\begin{aligned}
		-x &= A(x+\psi) + B(x+\phi) \\
		-(-\psi) &= A(-\psi+\psi) + B(-\psi+\phi) \\
		\psi &= B(-\psi+\phi) \\
		B &= \frac{\psi}{\phi-\psi}
		\end{aligned}
		\]
		
		<p>Using the fact that \(\phi-\psi=\sqrt{5}\), we get:</p>
		
		\[ B &= \frac{\psi}{\sqrt{5}}. \]
		
		<p>Now substitute these values of \(A\) and \(B\) into the partial fraction decomposition and we get:</p>
		
		\[ F(x) = \frac{1}{\sqrt{5}}(\frac{\psi}{x+\psi} - \frac{\phi}{x+\phi}). \]
		
		<p>Recall that the sum of a geometric series is given by</p>
		
		\[ \frac{1}{1-x} = \sum_{n=0}^{\infty} x^{n}, \]
		
		<p>assuming \(|x| \lt 1\) for convergence.</p>
		
		<p>The roots \(\phi\) and \(\psi\) are conjugates of each other, and they satisfy the product of the roots relationships:</p>
		
		\[ \phi \cdot \psi = -1. \]
		
		<p>Using the fact that \(\phi=-\frac{1}{\psi}\), we can rewrite the first term of the generating function as</p>
		
		\[
		\begin{aligned}
		\frac{\psi}{x+\psi} &= \frac{1}{1+\frac{x}{\psi}} \\
		&= \frac{1}{1-\psix} \\
		&= \sum_{n=0}^{\infty} \psi^{n} x^{n}.
		\end{aligned}
		\]
		
		<p>Similarly,</p>
		
		\[
		\begin{aligned}
		\frac{\phi}{x+\phi} &= \frac{1}{1+\frac{x}{\phi}} \\
		&= \frac{1}{1-\phix} \\
		&= \sum_{n=0}^{\infty} \phi^{n} x^{n}.
		\end{aligned}
		\]
		
		<p>so</p>
		
		\[
		\begin{aligned}
		F(x) = \frac{1}{\sqrt{5}}(\frac{\psi}{x+\psi} - \frac{\phi}{x+\phi}) \\
		&= \frac{1}{\sqrt{5}}(\sum_{n=0}^{\infty} \phi^{n} x^{n} - \sum_{n=0}^{\infty} \psi^{n} x^{n}) \\
		&= \sum_{n=0}^{\infty} \frac{1}{\sqrt{5}} (\phi^{n} - \psi^{n}) x^{n}.
		\end{aligned}
		\]
		
		<p>Since the definition of \(F(x)\) was</p>
		
		\[ F(x) = \sum_{n=0}^{\infty} F_{n} x^{n}, \]
		
		<p>we match the coefficients on corresponding powers of \(x\) in these two expressions for \(F(x)\) to finally arrive at the desired closed form for the n-th Fibonacci number,</p>
		
		\[ F_{n} = \frac{1}{\sqrt{5}} (\phi^{n} - \psi^{n}). \]
    </article>

    {% include post-tags.html %}

    {% include post-share.html %}
</div>